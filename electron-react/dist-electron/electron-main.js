"use strict";const{app:r,BrowserWindow:i,Menu:w,dialog:c,ipcMain:t}=require("electron"),a=require("path"),u=require("fs");let e;const l=process.env.NODE_ENV==="development"||!r.isPackaged;function d(){e=new i({width:1200,height:800,webPreferences:{nodeIntegration:!1,contextIsolation:!0,enableRemoteModule:!1,preload:a.join(__dirname,"electron-preload.js"),webSecurity:!l,cache:!l}}),l?(e.loadURL("http://localhost:5173"),e.webContents.openDevTools(),e.webContents.session.clearCache(),e.webContents.session.clearStorageData()):e.loadFile(a.join(__dirname,"../dist/index.html")),e.on("closed",()=>{e=null})}r.whenReady().then(d);r.on("window-all-closed",()=>{process.platform!=="darwin"&&r.quit()});r.on("activate",()=>{i.getAllWindows().length===0&&d()});t.handle("open-file-dialog",async()=>{try{const s=await c.showOpenDialog(e,{properties:["openFile"],filters:[{name:"Markdown Files",extensions:["md"]},{name:"All Files",extensions:["*"]}]});if(!s.canceled&&s.filePaths.length>0){const n=s.filePaths[0];return{success:!0,content:u.readFileSync(n,"utf8"),fileName:a.basename(n)}}else return{success:!1,canceled:!0}}catch(s){return{success:!1,error:s.message}}});t.handle("validate-workflow",async(s,n)=>n.trim().length>0?{success:!0}:{success:!1,error:"Workflow content is empty"});t.handle("execute-workflow",async(s,n,o)=>({success:!0,processId:Date.now().toString()}));t.handle("check-environment",async()=>({devinApiKey:!0,adoUrl:!0}));t.handle("save-results",async(s,n)=>{try{const o=await c.showSaveDialog(e,{filters:[{name:"HTML Files",extensions:["html"]},{name:"All Files",extensions:["*"]}]});if(!o.canceled&&o.filePath)return u.writeFileSync(o.filePath,n),{success:!0}}catch(o){return{success:!1,error:o.message}}});t.on("workflow-loaded",(s,n)=>{e.webContents.send("workflow-loaded",n)});t.on("save-results-request",()=>{e.webContents.send("save-results-request")});t.on("validate-workflow-request",()=>{e.webContents.send("validate-workflow-request")});t.on("execute-workflow-request",()=>{e.webContents.send("execute-workflow-request")});t.on("clear-results-request",()=>{e.webContents.send("clear-results-request")});
